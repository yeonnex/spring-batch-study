# 잡 (Job)
- _Job.class_: 실제로 잡을 구동한다. 잡 실행시 Job 인스턴스가 실행된다. </br>
아래 3개의 클래스들은 잡 구동시 메타 데이터를 저장하기 위해 사용되는 클래스들이다.  
- _JobInstance.class_
- _JobParameters.class_
- _JobExecution.class_

## Job.class
1. 개념
- 하나의 배치작업 자체를 의미
  - ex) "API 서버의 접속 로그 데이터를 통계 서버로 옮기는 배치"
- 배치작업을 어떻게 구성하고 실행할 것인지 전체적으로 설정하고 명세해 놓은 객체
- 배치 Job 을 구성하기 위한 최상위 인터페이스이며 스프링 배치가 기본 구현체 제공
- 여러 Step 을 포함하고 있는 컨테이너로서 반드시 한 개 이상의 Step 으로 구성
  - ```java
    public class SimpleJob extends AbstractJob {
    
	        private List<Step> steps = new ArrayList<>();
            ...
    }
    ```
2. 기본 구현체
- SimpleJob
  - 순차적으로 Step 을 실행시키는 Job
    - ex) step1 ---> step2 ---> step3
- FlowJob
  - 특정 조건에 따라 step 이 실행되는 Job
  - step1 ---> if (condition...) {step2 스킵} ---> step3
  - Flow 객체를 실행시켜 작업을 진행

## JobInstance.class
1. 개념
- 예를 들어 하루에 한번씩 잡이 실행된다면 매일 실행되는 그날의 Job 을 JobInstance 로 표현
2. JobInstance 생성 및 실행
- 한번도 저장되지 않은 Job + JobParameter 인지 DB 에서 조회하여 확인한다
- 그렇다면 새로운 JobInstace 를 생성한다
- 아니라면 (이전에 동일한 Job + JobParameter 로 배치를 실행한 적이 있다면) 이미 존재하는 JobInstance 를 리턴한다
  - 내부적으로는 jobName + jobKey (jobParameters 의 해시값) 를 가지고 JobInstance 객체를 얻는다
- Job 과는 1 : M 관계
3. `BATCH_JOB_INSTANCE` 테이블과 매핑

### JobExecution.class
1. 개념
- JobInstance 에 대한 한번의 시도를 의미하는 객체로서 Job 실행 중에 발생한 정보를 저장하고 있는 객체
- 시작시간, 종료시간, 상태(시작됨, 완료, 실패), 종료상태의 속성을 가짐
- **FAILED**, **COMPLETED** 등의 잡 실행 결과 상태를 가지고 있음
- 실행 결과가 **COMPLETED** 라면 해당 잡 인스턴스를 성공적으로 완료했음을 의미하므로 _재실행 불가_
- 실행 결과가 **FAILED** 라면 해당 잡 인스턴스를 처리하는데 실패했음을 의미하므로 _재실행 가능_
- 스텝이 두개가 있다면, 둘 중에 하나라도 실패하면 잡 전체는 실패. 잡 실행 재시도시, 만약 가장 처음 스텝은 성공했으나 두번쨰 스텝에서 실패했다면 처음 스텝은 이미 성공했으므로 건너뛰고 두번쨰 스텝만을 실행 (StepExecution)
2. `BATCH_JOB_EXECUTION` 테이블과 매핑
- JobInstance 와 1 : M 관계
- **COMPLETED** 일지라도 매 실행마다 ROW 가 쌓임